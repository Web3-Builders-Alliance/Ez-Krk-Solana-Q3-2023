use anchor_lang::prelude::*;

use crate::constants::*;

#[account]
pub struct Vulnerability {
    pub owner: Pubkey,
    pub protocol: Pubkey,
    pub title: String,
    pub form: Vec<String>,
    pub created_at: i64,
    pub bump: u8,
    pub seed: u64,
}

impl Vulnerability {
    pub const LEN: usize = DISCRIMINATOR_LENGTH
        + PUBLIC_KEY_LENGTH // owner
        + PUBLIC_KEY_LENGTH // form
        + VECTOR_LENGTH_PREFIX // 3 answers
        + TIMESTAMP_LENGTH
        + BUMP_LENGTH // bump
        + SEED_LENGTH // seed
        + MAX_PROTOCOL_LENGTH // title 50 char
        + ((STRING_LENGTH_PREFIX + MAX_ANSWER_LENGTH) * 5);
}
